---
title: "Preprocesado_imagenes"
output: html_document
---

```{r}
library(imager)

# Usaremos 1024x1024 para nuestro análisis posterior
nuevo_ancho <- 1024
nuevo_alto <- 1024

# Obtenemos la lista de archivos
archivos <- list.files("fotos_raw/", pattern = "\\.(jpg|jpeg|png)$", full.names = TRUE, ignore.case = TRUE)

# Bucle para procesar cada imagen
for (archivo in archivos) {
  
  # load.image ya normaliza los valores automáticamente al rango [0,1]
  img <- load.image(archivo)
  
  # Redimensionar (mismos px)
  img_resized <- resize(img, size_x = nuevo_ancho, size_y = nuevo_alto)
  
  # Restamos el mínimo y dividimos por el rango. Esto garantiza matemáticamente [0, 1]
  img_final <- (img_resized - min(img_resized)) / (max(img_resized) - min(img_resized))
  
  # Guardar imagen procesada
  nombre_archivo <- tools::file_path_sans_ext(basename(archivo))
  ruta_salida <- paste0("fotos_clean/", "clean_", nombre_archivo, ".jpg")
  
  save.image(img_final, ruta_salida)
  
  print(paste("Procesada:", nombre_archivo, "-> Dimensiones:", dim(img_final)[1], "x", dim(img_final)[2], " -> Rango: [", round(range(img_final)[1],2),",", round(range(img_final)[2],2), "]"))
}
```
